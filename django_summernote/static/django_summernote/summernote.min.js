(function(e){if(typeof define==="function"&&define.amd){define(["jquery","codemirror"],e)}else{e(window.jQuery,window.CodeMirror)}})(function(e,t){if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(e,t){var n,r,i=this.length>>>0,s=false;if(1<arguments.length){r=t;s=true}for(n=0;i>n;++n){if(this.hasOwnProperty(n)){if(s){r=e(r,this[n],n,this)}else{r=this[n];s=true}}}if(!s){throw new TypeError("Reduce of empty array with no initial value")}return r}}var n={bMac:navigator.appVersion.indexOf("Mac")>-1,bMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,bFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(e.fn.jquery),bCodeMirror:!!t};var r=function(){var t=function(e){return function(t){return e===t}};var n=function(e,t){return e===t};var r=function(){return true};var i=function(){return false};var s=function(e){return function(){return!e.apply(e,arguments)}};var o=function(e){return e};var u=0;var a=function(e){var t=++u+"";return e?e+t:t};var f=function(t){var n=e(document);return{top:t.top+n.scrollTop(),left:t.left+n.scrollLeft(),width:t.right-t.left,height:t.bottom-t.top}};var l=function(e){var t={};for(var n in e){if(e.hasOwnProperty(n)){t[e[n]]=n}}return t};return{eq:t,eq2:n,ok:r,fail:i,not:s,self:o,uniqueId:a,rect2bnd:f,invertObject:l}}();var i=function(){var e=function(e){return e[0]};var t=function(e){return e[e.length-1]};var n=function(e){return e.slice(0,e.length-1)};var i=function(e){return e.slice(1)};var s=function(e,t){var n=e.indexOf(t);if(n===-1){return null}return e[n+1]};var o=function(e,t){var n=e.indexOf(t);if(n===-1){return null}return e[n-1]};var u=function(e,t){t=t||r.self;return e.reduce(function(e,n){return e+t(n)},0)};var a=function(e){var t=[],n=-1,r=e.length;while(++n<r){t[n]=e[n]}return t};var f=function(n,r){if(!n.length){return[]}var s=i(n);return s.reduce(function(e,n){var i=t(e);if(r(t(i),n)){i[i.length]=n}else{e[e.length]=[n]}return e},[[e(n)]])};var l=function(e){var t=[];for(var n=0,r=e.length;n<r;n++){if(e[n]){t.push(e[n])}}return t};return{head:e,last:t,initial:n,tail:i,prev:o,next:s,sum:u,from:a,compact:l,clusterBy:f}}();var s=function(){var t=function(t){return t&&e(t).hasClass("note-editable")};var o=function(t){return t&&e(t).hasClass("note-control-sizing")};var u=function(t){var n;if(t.hasClass("note-air-editor")){var r=i.last(t.attr("id").split("-"));n=function(t){return function(){return e(t+r)}};return{editor:function(){return t},editable:function(){return t},popover:n("#note-popover-"),handle:n("#note-handle-"),dialog:n("#note-dialog-")}}else{n=function(e){return function(){return t.find(e)}};return{editor:function(){return t},dropzone:n(".note-dropzone"),toolbar:n(".note-toolbar"),editable:n(".note-editable"),codable:n(".note-codable"),statusbar:n(".note-statusbar"),popover:n(".note-popover"),handle:n(".note-handle"),dialog:n(".note-dialog")}}};var a=function(e){return function(t){return t&&t.nodeName===e}};var f=function(e){return e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName)};var l=function(e){return e&&/^UL|^OL/.test(e.nodeName)};var c=function(e){return e&&/^TD|^TH/.test(e.nodeName)};var h=function(e,n){while(e){if(n(e)){return e}if(t(e)){break}e=e.parentNode}return null};var p=function(e,t){t=t||r.fail;var n=[];h(e,function(e){n.push(e);return t(e)});return n};var d=function(t,n){var r=p(t);for(var i=n;i;i=i.parentNode){if(e.inArray(i,r)>-1){return i}}return null};var v=function(e,t){var n=[];var r=false,i=false;(function s(o){if(!o){return}if(o===e){r=true}if(r&&!i){n.push(o)}if(o===t){i=true;return}for(var u=0,a=o.childNodes.length;u<a;u++){s(o.childNodes[u])}})(d(e,t));return n};var m=function(e,t){t=t||r.fail;var n=[];while(e){n.push(e);if(t(e)){break}e=e.previousSibling}return n};var g=function(e,t){t=t||r.fail;var n=[];while(e){n.push(e);if(t(e)){break}e=e.nextSibling}return n};var y=function(e,t){var n=[];t=t||r.ok;(function i(r){if(e!==r&&t(r)){n.push(r)}for(var s=0,o=r.childNodes.length;s<o;s++){i(r.childNodes[s])}})(e);return n};var b=function(e,t){var n=t.nextSibling,r=t.parentNode;if(n){r.insertBefore(e,n)}else{r.appendChild(e)}return e};var w=function(t,n){e.each(n,function(e,n){t.appendChild(n)});return t};var E=a("#text");var S=function(e){if(E(e)){return e.nodeValue.length}return e.childNodes.length};var x=function(e){var t=0;while(e=e.previousSibling){t+=1}return t};var T=function(t,n){var s=i.initial(p(n,r.eq(t)));return e.map(s,x).reverse()};var N=function(e,t){var n=e;for(var r=0,i=t.length;r<i;r++){n=n.childNodes[t[r]]}return n};var C=function(e,t){if(t===0){return e}if(t>=S(e)){return e.nextSibling}if(E(e)){return e.splitText(t)}var n=e.childNodes[t];e=b(e.cloneNode(false),e);return w(e,g(n))};var k=function(e,t,n){var i=p(t,r.eq(e));if(i.length===1){return C(t,n)}return i.reduce(function(e,r){var i=r.cloneNode(false);b(i,r);if(e===t){e=C(e,n)}w(i,g(e));return i})};var L=function(e,t){if(!e||!e.parentNode){return}if(e.removeNode){return e.removeNode(t)}var n=e.parentNode;if(!t){var r=[];var i,s;for(i=0,s=e.childNodes.length;i<s;i++){r.push(e.childNodes[i])}for(i=0,s=r.length;i<s;i++){n.insertBefore(r[i],e)}}n.removeChild(e)};var A=function(e){return s.isTextarea(e[0])?e.val():e.html()};return{blank:n.bMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:t,isControlSizing:o,buildLayoutInfo:u,isText:E,isPara:f,isList:l,isTable:a("TABLE"),isCell:c,isAnchor:a("A"),isDiv:a("DIV"),isLi:a("LI"),isSpan:a("SPAN"),isB:a("B"),isU:a("U"),isS:a("S"),isI:a("I"),isImg:a("IMG"),isTextarea:a("TEXTAREA"),ancestor:h,listAncestor:p,listNext:g,listPrev:m,listDescendant:y,commonAncestor:d,listBetween:v,insertAfter:b,position:x,makeOffsetPath:T,fromOffsetPath:N,split:k,remove:L,html:A}}();var o={version:"0.5.2",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:false,tabsize:4,styleWithSpan:true,disableLinkTarget:false,disableDragAndDrop:false,disableResizeEditor:false,codemirror:{mode:"text/html",lineNumbers:true},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:false,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Arial",fontNames:["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",edit:"Edit image",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, or DailyMotion)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"BackColor",foreground:"FontColor",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}};var u=function(){var t=function(t){return e.Deferred(function(n){e.extend(new FileReader,{onload:function(e){var t=e.target.result;n.resolve(t)},onerror:function(){n.reject(this)}}).readAsDataURL(t)}).promise()};var n=function(t){return e.Deferred(function(n){e("<img>").one("load",function(){n.resolve(e(this))}).one("error abort",function(){n.reject(e(this))}).css({display:"none"}).appendTo(document.body).attr("src",t)}).promise()};return{readFileAsDataURL:t,createImage:n}}();var a={isEdit:function(e){return[8,9,13,32].indexOf(e)!==-1},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}};var f=function(){var t=function(t,r){if(n.jqueryVersion<1.9){var i={};e.each(r,function(e,n){i[n]=t.css(n)});return i}return t.css.call(t,r)};this.stylePara=function(t,n){e.each(t.nodes(s.isPara),function(t,r){e(r).css(n)})};this.current=function(n,r){var i=e(s.isText(n.sc)?n.sc.parentNode:n.sc);var o=["font-family","font-size","text-align","list-style-type","line-height"];var u=t(i,o)||{};u["font-size"]=parseInt(u["font-size"],10);u["font-bold"]=document.queryCommandState("bold")?"bold":"normal";u["font-italic"]=document.queryCommandState("italic")?"italic":"normal";u["font-underline"]=document.queryCommandState("underline")?"underline":"normal";u["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal";u["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal";u["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal";if(!n.isOnList()){u["list-style"]="none"}else{var a=["circle","disc","disc-leading-zero","square"];var f=e.inArray(u["list-style-type"],a)>-1;u["list-style"]=f?"unordered":"ordered"}var l=s.ancestor(n.sc,s.isPara);if(l&&l.style["line-height"]){u["line-height"]=l.style.lineHeight}else{var c=parseInt(u["line-height"],10)/parseInt(u["font-size"],10);u["line-height"]=c.toFixed(1)}u.image=s.isImg(r)&&r;u.anchor=n.isOnAnchor()&&s.ancestor(n.sc,s.isAnchor);u.aAncestor=s.listAncestor(n.sc,s.isEditable);u.range=n;return u}};var l=function(){var t=!!document.createRange;var n=function(e,t){var n=e.parentElement(),r;var o=document.body.createTextRange(),u;var a=i.from(n.childNodes);for(r=0;r<a.length;r++){if(s.isText(a[r])){continue}o.moveToElementText(a[r]);if(o.compareEndPoints("StartToStart",e)>=0){break}u=a[r]}if(r!==0&&s.isText(a[r-1])){var f=document.body.createTextRange(),l=null;f.moveToElementText(u||n);f.collapse(!u);l=u?u.nextSibling:n.firstChild;var c=e.duplicate();c.setEndPoint("StartToStart",f);var h=c.text.replace(/[\r\n]/g,"").length;while(h>l.nodeValue.length&&l.nextSibling){h-=l.nodeValue.length;l=l.nextSibling}var p=l.nodeValue;if(t&&l.nextSibling&&s.isText(l.nextSibling)&&h===l.nodeValue.length){h-=l.nodeValue.length;l=l.nextSibling}n=l;r=h}return{cont:n,offset:r}};var o=function(e){var t=function(e,n){var o,u;if(s.isText(e)){var a=s.listPrev(e,r.not(s.isText));var f=i.last(a).previousSibling;o=f||e.parentNode;n+=i.sum(i.tail(a),s.length);u=!f}else{o=e.childNodes[n]||e;if(s.isText(o)){return t(o,n)}n=0;u=false}return{cont:o,collapseToStart:u,offset:n}};var n=document.body.createTextRange();var o=t(e.cont,e.offset);n.moveToElementText(o.cont);n.collapse(o.collapseToStart);n.moveStart("character",o.offset);return n};var u=function(n,u,a,f){this.sc=n;this.so=u;this.ec=a;this.eo=f;var l=function(){if(t){var e=document.createRange();e.setStart(n,u);e.setEnd(a,f);return e}else{var r=o({cont:n,offset:u});r.setEndPoint("EndToEnd",o({cont:a,offset:f}));return r}};this.select=function(){var e=l();if(t){var n=document.getSelection();if(n.rangeCount>0){n.removeAllRanges()}n.addRange(e)}else{e.select()}};this.nodes=function(t){var o=s.listBetween(n,a);var u=i.compact(e.map(o,function(e){return s.ancestor(e,t)}));return e.map(i.clusterBy(u,r.eq2),i.head)};this.commonAncestor=function(){return s.commonAncestor(n,a)};var c=function(e){return function(){var t=s.ancestor(n,e);return!!t&&t===s.ancestor(a,e)}};this.isOnEditable=c(s.isEditable);this.isOnList=c(s.isList);this.isOnAnchor=c(s.isAnchor);this.isOnCell=c(s.isCell);this.isCollapsed=function(){return n===a&&u===f};this.insertNode=function(e){var n=l();if(t){n.insertNode(e)}else{n.pasteHTML(e.outerHTML)}};this.toString=function(){var e=l();return t?e.toString():e.text};this.bookmark=function(e){return{s:{path:s.makeOffsetPath(e,n),offset:u},e:{path:s.makeOffsetPath(e,a),offset:f}}};this.getClientRects=function(){var e=l();return e.getClientRects()}};return{create:function(e,r,i,s){if(!arguments.length){if(t){var o=document.getSelection();if(o.rangeCount===0){return null}var a=o.getRangeAt(0);e=a.startContainer;r=a.startOffset;i=a.endContainer;s=a.endOffset}else{var f=document.selection.createRange();var l=f.duplicate();l.collapse(false);var c=f;c.collapse(true);var h=n(c,true),p=n(l,false);e=h.cont;r=h.offset;i=p.cont;s=p.offset}}else if(arguments.length===2){i=e;s=r}return new u(e,r,i,s)},createFromNode:function(e){return this.create(e,0,e,1)},createFromBookmark:function(e,t){var n=s.fromOffsetPath(e,t.s.path);var r=t.s.offset;var i=s.fromOffsetPath(e,t.e.path);var o=t.e.offset;return new u(n,r,i,o)}}}();var c=function(){this.tab=function(e,t){var n=s.ancestor(e.commonAncestor(),s.isCell);var r=s.ancestor(n,s.isTable);var o=s.listDescendant(r,s.isCell);var u=i[t?"prev":"next"](o,n);if(u){l.create(u,0).select()}};this.createTable=function(t,n){var r=[],i;for(var o=0;o<t;o++){r.push("<td>"+s.blank+"</td>")}i=r.join("");var u=[],a;for(var f=0;f<n;f++){u.push("<tr>"+i+"</tr>")}a=u.join("");var l='<table class="table table-bordered">'+a+"</table>";return e(l)[0]}};var h=function(){var t=new f;var r=new c;this.saveRange=function(e){e.focus();e.data("range",l.create())};this.restoreRange=function(e){var t=e.data("range");if(t){t.select();e.focus()}};this.currentStyle=function(e){var n=l.create();return n.isOnEditable()&&t.current(n,e)};this.undo=function(e){e.data("NoteHistory").undo(e)};this.redo=function(e){e.data("NoteHistory").redo(e)};var i=this.recordUndo=function(e){e.data("NoteHistory").recordUndo(e)};var o=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"];for(var a=0,h=o.length;a<h;a++){this[o[a]]=function(e){return function(t,n){i(t);document.execCommand(e,false,n)}}(o[a])}var p=function(t,n,r){i(t);var o=(new Array(r+1)).join("&nbsp;");n.insertNode(e('<span id="noteTab">'+o+"</span>")[0]);var u=e("#noteTab").removeAttr("id");n=l.create(u[0],1);n.select();s.remove(u[0])};this.tab=function(e,t){var n=l.create();if(n.isCollapsed()&&n.isOnCell()){r.tab(n)}else{p(e,n,t.tabsize)}};this.untab=function(){var e=l.create();if(e.isCollapsed()&&e.isOnCell()){r.tab(e,true)}};this.insertImage=function(e,t){u.createImage(t).then(function(t){i(e);t.css({display:"",width:Math.min(e.width(),t.width())});l.create().insertNode(t[0])}).fail(function(){var t=e.data("callbacks");if(t.onImageUploadError){t.onImageUploadError()}})};this.insertVideo=function(t,n){i(t);var r=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var s=n.match(r);var o=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/;var u=n.match(o);var a=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/;var f=n.match(a);var c=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/;var h=n.match(c);var p=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/;var d=n.match(p);var v;if(s&&s[2].length===11){var m=s[2];v=e("<iframe>").attr("src","//www.youtube.com/embed/"+m).attr("width","640").attr("height","360")}else if(u&&u[0].length){v=e("<iframe>").attr("src",u[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true")}else if(f&&f[0].length){v=e("<iframe>").attr("src",f[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed")}else if(h&&h[3].length){v=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360")}else if(d&&d[2].length){v=e("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+d[2]).attr("width","640").attr("height","360")}else{}if(v){v.attr("frameborder",0);l.create().insertNode(v[0])}};this.formatBlock=function(e,t){i(e);t=n.bMSIE?"<"+t+">":t;document.execCommand("FormatBlock",false,t)};this.formatPara=function(e){this.formatBlock(e,"P")};for(var a=1;a<=6;a++){this["formatH"+a]=function(e){return function(t){this.formatBlock(t,"H"+e)}}(a)}this.fontSize=function(e,t){i(e);document.execCommand("fontSize",false,3);if(n.bFF){e.find("font[size=3]").removeAttr("size").css("font-size",t+"px")}else{e.find("span").filter(function(){return this.style.fontSize==="medium"}).css("font-size",t+"px")}};this.lineHeight=function(e,n){i(e);t.stylePara(l.create(),{lineHeight:n})};this.unlink=function(e){var t=l.create();if(t.isOnAnchor()){i(e);var n=s.ancestor(t.sc,s.isAnchor);t=l.createFromNode(n);t.select();document.execCommand("unlink")}};this.createLink=function(t,r,o,u){var a=l.create();i(t);var f=o;if(o.indexOf("@")!==-1&&o.indexOf(":")===-1){f="mailto:"+o}else if(o.indexOf("://")===-1){f="http://"+o}if(!a.isOnAnchor()){if((n.bMSIE||n.bFF)&&a.isCollapsed()){a.insertNode(e('<A id="linkAnchor">'+r+"</A>")[0]);var c=e("#linkAnchor").attr("href",f).removeAttr("id");a=l.createFromNode(c[0]);a.select()}else{document.execCommand("createlink",false,f)}}e.each(a.nodes(s.isAnchor),function(t,n){e(n).html(r);if(u){e(n).attr("target","_blank")}else{e(n).removeAttr("target")}})};this.getLinkInfo=function(t){t.focus();var n=l.create();var r=true;var i="";if(n.isOnAnchor()){var o=s.ancestor(n.sc,s.isAnchor);n=l.createFromNode(o);r=e(o).attr("target")==="_blank";i=o.href}return{text:n.toString(),url:i,newWindow:r}};this.getVideoInfo=function(e){e.focus();var t=l.create();if(t.isOnAnchor()){var n=s.ancestor(t.sc,s.isAnchor);t=l.createFromNode(n)}return{text:t.toString()}};this.color=function(e,t){var n=JSON.parse(t);var r=n.foreColor,s=n.backColor;i(e);if(r){document.execCommand("foreColor",false,r)}if(s){document.execCommand("backColor",false,s)}};this.insertTable=function(e,t){i(e);var n=t.split("x");l.create().insertNode(r.createTable(n[0],n[1]))};this.floatMe=function(e,t,n){i(e);n.css("float",t)};this.editButton=function(e,t,n){i(e);n.attr("id","aviary_image_editor_"+Math.random()*(9999-10)+10);window.featherEditor.launch({image:n.get(0),url:n.attr("src")})};this.resize=function(e,t,n){i(e);n.css({width:e.width()*t+"px",height:""})};this.resizeTo=function(e,t,n){var r;if(n){var i=e.y/e.x;var s=t.data("ratio");r={width:s>i?e.x:e.y/s,height:s>i?e.x*s:e.y}}else{r={width:e.x,height:e.y}}t.css(r)};this.removeMedia=function(e,t,n){i(e);console.log(n)}};var p=function(){var e=[],t=[];var n=function(e){var t=e[0],n=l.create();return{contents:e.html(),bookmark:n.bookmark(t),scrollTop:e.scrollTop()}};var r=function(e,t){e.html(t.contents).scrollTop(t.scrollTop);l.createFromBookmark(e[0],t.bookmark).select()};this.undo=function(i){var s=n(i);if(!e.length){return}r(i,e.pop());t.push(s)};this.redo=function(i){var s=n(i);if(!t.length){return}r(i,t.pop());e.push(s)};this.recordUndo=function(r){t=[];e.push(n(r))}};var d=function(){this.update=function(t,n){var r=function(t,n){t.find(".dropdown-menu li a").each(function(){var t=e(this).data("value")+""===n+"";this.className=t?"checked":""})};var s=function(e,n){var r=t.find(e);r.toggleClass("active",n())};var o=t.find(".note-fontname");if(o.length){var u=n["font-family"];if(!!u){u=i.head(u.split(","));u=u.replace(/\'/g,"");o.find(".note-current-fontname").text(u);r(o,u)}}var a=t.find(".note-fontsize");a.find(".note-current-fontsize").text(n["font-size"]);r(a,parseFloat(n["font-size"]));var f=t.find(".note-height");r(f,parseFloat(n["line-height"]));s('button[data-event="bold"]',function(){return n["font-bold"]==="bold"});s('button[data-event="italic"]',function(){return n["font-italic"]==="italic"});s('button[data-event="underline"]',function(){return n["font-underline"]==="underline"});s('button[data-event="strikethrough"]',function(){return n["font-strikethrough"]==="strikethrough"});s('button[data-event="superscript"]',function(){return n["font-superscript"]==="superscript"});s('button[data-event="subscript"]',function(){return n["font-subscript"]==="subscript"});s('button[data-event="justifyLeft"]',function(){return n["text-align"]==="left"||n["text-align"]==="start"});s('button[data-event="justifyCenter"]',function(){return n["text-align"]==="center"});s('button[data-event="justifyRight"]',function(){return n["text-align"]==="right"});s('button[data-event="justifyFull"]',function(){return n["text-align"]==="justify"});s('button[data-event="insertUnorderedList"]',function(){return n["list-style"]==="unordered"});s('button[data-event="insertOrderedList"]',function(){return n["list-style"]==="ordered"})};this.updateRecentColor=function(t,n,r){var i=e(t).closest(".note-color");var s=i.find(".note-recent-color");var o=JSON.parse(s.attr("data-value"));o[n]=r;s.attr("data-value",JSON.stringify(o));var u=n==="backColor"?"background-color":"color";s.find("i").css(u,r)}};var v=function(){var e=new d;this.update=function(t,n){e.update(t,n)};this.updateRecentColor=function(t,n,r){e.updateRecentColor(t,n,r)};this.activate=function(e){e.find("button").not('button[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(e){e.find("button").not('button[data-event="codeview"]').addClass("disabled")};this.updateFullscreen=function(e,t){var n=e.find('button[data-event="fullscreen"]');n.toggleClass("active",t)};this.updateCodeview=function(e,t){var n=e.find('button[data-event="codeview"]');n.toggleClass("active",t)}};var m=function(){var t=new d;var n=function(t,n){var r=e(n);var i=r.position();var s=r.outerHeight(true);t.css({display:"block",left:i.left,top:i.top+s})};var s=20;this.update=function(e,o,u){t.update(e,o);var a=e.find(".note-link-popover");if(o.anchor){var f=a.find("a");f.attr("href",o.anchor.href).html(o.anchor.href);n(a,o.anchor)}else{a.hide()}var l=e.find(".note-image-popover");if(o.image){n(l,o.image)}else{l.hide()}if(u){var c=e.find(".note-air-popover");if(!o.range.isCollapsed()){var h=r.rect2bnd(i.last(o.range.getClientRects()));c.css({display:"block",left:Math.max(h.left+h.width/2-s,0),top:h.top+h.height})}else{c.hide()}}};this.updateRecentColor=function(e,n,r){t.updateRecentColor(e,n,r)};this.hide=function(e){e.children().hide()}};var g=function(){this.update=function(t,n){var r=t.find(".note-control-selection");if(n.image){var i=e(n.image);var s=i.position();var o={w:i.outerWidth(true),h:i.outerHeight(true)};r.css({display:"block",left:s.left,top:s.top,width:o.w,height:o.h}).data("target",n.image);var u=o.w+"x"+o.h;r.find(".note-control-selection-info").text(u)}else{r.hide()}};this.hide=function(e){e.children().hide()}};var y=function(){var t=function(e,t){e.toggleClass("disabled",!t);e.attr("disabled",!t)};this.showImageDialog=function(n,r){return e.Deferred(function(e){var n=r.find(".note-image-dialog");var i=r.find(".note-image-input"),s=r.find(".note-image-url"),o=r.find(".note-image-btn");n.one("shown.bs.modal",function(){i.replaceWith(i.clone().on("change",function(){e.resolve(this.files);n.modal("hide")}));o.click(function(t){t.preventDefault();e.resolve(s.val());n.modal("hide")});s.keyup(function(){t(o,s.val())}).val("").trigger("focus")}).one("hidden.bs.modal",function(){i.off("change");s.off("keyup");o.off("click");if(e.state()==="pending"){e.reject()}}).modal("show")})};this.showVideoDialog=function(n,r,i){return e.Deferred(function(e){var n=r.find(".note-video-dialog");var s=n.find(".note-video-url"),o=n.find(".note-video-btn");n.one("shown.bs.modal",function(){s.val(i.text).keyup(function(){t(o,s.val())}).trigger("keyup").trigger("focus");o.click(function(t){t.preventDefault();e.resolve(s.val());n.modal("hide")})}).one("hidden.bs.modal",function(){s.off("keyup");o.off("click");if(e.state()==="pending"){e.reject()}}).modal("show")})};this.showLinkDialog=function(n,r,i){return e.Deferred(function(e){var n=r.find(".note-link-dialog");var s=n.find(".note-link-text"),o=n.find(".note-link-url"),u=n.find(".note-link-btn"),a=n.find("input[type=checkbox]");n.one("shown.bs.modal",function(){s.val(i.text);s.keyup(function(){i.text=s.val()});if(!i.url){i.url=i.text;t(u,i.text)}o.keyup(function(){t(u,o.val());if(!i.text){s.val(o.val())}}).val(i.url).trigger("focus").trigger("select");a.prop("checked",i.newWindow);u.one("click",function(t){t.preventDefault();e.resolve(s.val(),o.val(),a.is(":checked"));n.modal("hide")})}).one("hidden.bs.modal",function(){o.off("keyup");if(e.state()==="pending"){e.reject()}}).modal("show")}).promise()};this.showHelpDialog=function(t,n){return e.Deferred(function(e){var t=n.find(".note-help-dialog");t.one("hidden.bs.modal",function(){e.resolve()}).modal("show")}).promise()}};var b=function(){var r=e(window);var o=e(document);var f=e("html, body");var l=new h;var c=new v,d=new m;var b=new g,w=new y;var E=function(t){var n=e(t).closest(".note-editor, .note-air-editor, .note-air-layout");if(!n.length){return null}var r;if(n.is(".note-editor, .note-air-editor")){r=n}else{r=e("#note-editor-"+i.last(n.attr("id").split("-")))}return s.buildLayoutInfo(r)};var S=function(t,n){l.restoreRange(t);var r=t.data("callbacks");if(r.onImageUpload){r.onImageUpload(n,l,t)}else{e.each(n,function(e,n){u.readFileAsDataURL(n).then(function(e){l.insertImage(t,e)}).fail(function(){if(r.onImageUploadError){r.onImageUploadError()}})})}};var x={showLinkDialog:function(e){var t=e.dialog(),n=e.editable(),r=l.getLinkInfo(n);l.saveRange(n);w.showLinkDialog(n,t,r).then(function(t,r,i){l.restoreRange(n);l.createLink(n,t,r,i);d.hide(e.popover())}).fail(function(){l.restoreRange(n)})},showImageDialog:function(e){var t=e.dialog(),n=e.editable();l.saveRange(n);w.showImageDialog(n,t).then(function(e){l.restoreRange(n);if(typeof e==="string"){l.insertImage(n,e)}else{S(n,e)}}).fail(function(){l.restoreRange(n)})},showVideoDialog:function(e){var t=e.dialog(),n=e.editable(),r=l.getVideoInfo(n);l.saveRange(n);w.showVideoDialog(n,t,r).then(function(e){l.restoreRange(n);l.insertVideo(n,e)}).fail(function(){l.restoreRange(n)})},showHelpDialog:function(e){var t=e.dialog(),n=e.editable();l.saveRange(n);w.showHelpDialog(n,t).then(function(){l.restoreRange(n)})},fullscreen:function(e){var t=e.editor(),n=e.toolbar(),i=e.editable(),s=e.codable();var o=t.data("options");var u=function(e){t.css("width",e.w);i.css("height",e.h);s.css("height",e.h);if(s.data("cmeditor")){s.data("cmeditor").setsize(null,e.h)}};t.toggleClass("fullscreen");var a=t.hasClass("fullscreen");if(a){i.data("orgheight",i.css("height"));r.on("resize",function(){u({w:r.width(),h:r.height()-n.outerHeight()})}).trigger("resize");f.css("overflow","hidden")}else{r.off("resize");u({w:o.width||"",h:i.data("orgheight")});f.css("overflow","visible")}c.updateFullscreen(n,a)},codeview:function(e){var r=e.editor(),i=e.toolbar(),o=e.editable(),u=e.codable(),a=e.popover();var f=r.data("options");var l,h;r.toggleClass("codeview");var p=r.hasClass("codeview");if(p){u.val(o.html());u.height(o.height());c.deactivate(i);d.hide(a);u.focus();if(n.bCodeMirror){l=t.fromTextArea(u[0],f.codemirror);if(f.codemirror.tern){h=new t.TernServer(f.codemirror.tern);l.ternServer=h;l.on("cursorActivity",function(e){h.updateArgHints(e)})}l.setSize(null,o.outerHeight());if(l.autoFormatRange){l.autoFormatRange({line:0,ch:0},{line:l.lineCount(),ch:l.getTextArea().value.length})}u.data("cmEditor",l)}}else{if(n.bCodeMirror){l=u.data("cmEditor");u.val(l.getValue());l.toTextArea()}o.html(u.val()||s.emptyPara);o.height(f.height?u.height():"auto");c.activate(i);o.focus()}c.updateCodeview(e.toolbar(),p)}};var T=function(e){if(s.isImg(e.target)){e.preventDefault()}};var N=function(e){setTimeout(function(){var t=E(e.currentTarget||e.target);var n=l.currentStyle(e.target);if(!n){return}var r=t.editor().data("options").airMode;if(!r){c.update(t.toolbar(),n)}d.update(t.popover(),n,r);b.update(t.handle(),n)},0)};var C=function(e){var t=E(e.currentTarget||e.target);d.hide(t.popover());b.hide(t.handle())};var k=function(e){var t=e.originalEvent.clipboardData;if(!t||!t.items||!t.items.length){return}var n=E(e.currentTarget||e.target);var r=i.head(t.items);var s=r.kind==="file"&&r.type.indexOf("image/")!==-1;if(s){S(n.editable(),[r.getAsFile()])}};var L=function(t){if(s.isControlSizing(t.target)){t.preventDefault();t.stopPropagation();var n=E(t.target),r=n.handle(),i=n.popover(),u=n.editable();var a=r.find(".note-control-selection").data("target"),f=e(a),c=f.offset(),h=o.scrollTop();o.on("mousemove",function(e){l.resizeTo({x:e.clientX-c.left,y:e.clientY-(c.top-h)},f,!e.shiftKey);b.update(r,{image:a});d.update(i,{image:a})}).one("mouseup",function(){o.off("mousemove")});if(!f.data("ratio")){f.data("ratio",f.height()/f.width())}l.recordUndo(u)}};var A=function(t){var n=e(t.target).closest("[data-event]");if(n.length){t.preventDefault()}};var O=function(t){var n=e(t.target).closest("[data-event]");if(n.length){var r=n.attr("data-event"),s=n.attr("data-value");var o=E(t.target);var u;if(e.inArray(r,["resize","floatMe","removeMedia","editButton"])!==-1){var a=o.handle().find(".note-control-selection");u=e(a.data("target"))}if(l[r]){var f=o.editable();f.trigger("focus");l[r](f,s,u)}else if(x[r]){x[r].call(this,o)}if(e.inArray(r,["backColor","foreColor"])!==-1){var h=o.editor().data("options",h);var p=h.airMode?d:c;p.updateRecentColor(i.head(n),r,s)}N(t)}};var M=24;var _=function(e){e.preventDefault();e.stopPropagation();var t=E(e.target).editable();var n=t.offset().top-o.scrollTop();var r=E(e.currentTarget||e.target);var i=r.editor().data("options");o.on("mousemove",function(e){var r=e.clientY-(n+M);r=i.minHeight>0?Math.max(r,i.minHeight):r;r=i.maxHeight>0?Math.min(r,i.maxHeight):r;t.height(r)}).one("mouseup",function(){o.off("mousemove")})};var D=18;var P=function(t){var n=e(t.target.parentNode);var r=n.next();var i=n.find(".note-dimension-picker-mousecatcher");var s=n.find(".note-dimension-picker-highlighted");var o=n.find(".note-dimension-picker-unhighlighted");var u;if(t.offsetX===undefined){var a=e(t.target).offset();u={x:t.pageX-a.left,y:t.pageY-a.top}}else{u={x:t.offsetX,y:t.offsetY}}var f={c:Math.ceil(u.x/D)||1,r:Math.ceil(u.y/D)||1};s.css({width:f.c+"em",height:f.r+"em"});i.attr("data-value",f.c+"x"+f.r);if(3<f.c&&f.c<10){o.css({width:f.c+1+"em"})}if(3<f.r&&f.r<10){o.css({height:f.r+1+"em"})}r.html(f.c+" x "+f.r)};var H=function(t){var n=e(),r=t.dropzone,i=t.dropzone.find(".note-dropzone-message");o.on("dragenter",function(e){var s=t.editor.hasClass("codeview");if(!s&&!n.length){t.editor.addClass("dragover");r.width(t.editor.width());r.height(t.editor.height());i.text("Drag Image Here")}n=n.add(e.target)}).on("dragleave",function(e){n=n.not(e.target);if(!n.length){t.editor.removeClass("dragover")}}).on("drop",function(){n=e();t.editor.removeClass("dragover")});r.on("dragenter",function(){r.addClass("hover");i.text("Drop Image")}).on("dragleave",function(){r.removeClass("hover");i.text("Drag Image Here")});r.on("drop",function(e){e.preventDefault();var t=e.originalEvent.dataTransfer;if(t&&t.files){var n=E(e.currentTarget||e.target);n.editable().focus();S(n.editable(),t.files)}}).on("dragover",false)};this.bindKeyMap=function(e,t){var n=e.editor;var r=e.editable;e=E(r);r.on("keydown",function(i){var s=[];if(i.metaKey){s.push("CMD")}if(i.ctrlKey){s.push("CTRL")}if(i.shiftKey){s.push("SHIFT")}var o=a.nameFromCode[i.keyCode];if(o){s.push(o)}var u=t[s.join("+")];if(u){i.preventDefault();if(l[u]){l[u](r,n.data("options"))}else if(x[u]){x[u].call(this,e)}}else if(a.isEdit(i.keyCode)){l.recordUndo(r)}})};this.attach=function(e,t){this.bindKeyMap(e,t.keyMap[n.bMac?"mac":"pc"]);e.editable.on("mousedown",T);e.editable.on("keyup mouseup",N);e.editable.on("scroll",C);e.editable.on("paste",k);e.handle.on("mousedown",L);e.popover.on("click",O);e.popover.on("mousedown",A);if(!t.airMode){if(!t.disableDragAndDrop){H(e)}e.toolbar.on("click",O);e.toolbar.on("mousedown",A);if(!t.disableResizeEditor){e.statusbar.on("mousedown",_)}}var r=t.airMode?e.popover:e.toolbar;var i=r.find(".note-dimension-picker-mousecatcher");i.on("mousemove",P);e.editor.data("options",t);if(t.styleWithSpan&&!n.bMSIE){setTimeout(function(){document.execCommand("styleWithCSS",0,true)},0)}e.editable.data("NoteHistory",new p);if(t.onenter){e.editable.keypress(function(e){if(e.keyCode===a.ENTER){t.onenter(e)}})}if(t.onfocus){e.editable.focus(t.onfocus)}if(t.onblur){e.editable.blur(t.onblur)}if(t.onkeyup){e.editable.keyup(t.onkeyup)}if(t.onkeydown){e.editable.keydown(t.onkeydown)}if(t.onpaste){e.editable.on("paste",t.onpaste)}if(t.onToolbarClick){e.toolbar.click(t.onToolbarClick)}if(t.onChange){var s=function(){t.onChange(e.editable,e.editable.html())};if(n.bMSIE){var o="DOMCharacterDataModified, DOMSubtreeModified, DOMNodeInserted";e.editable.on(o,s)}else{e.editable.on("input",s)}}e.editable.data("callbacks",{onAutoSave:t.onAutoSave,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onFileUpload:t.onFileUpload,onFileUploadError:t.onFileUpload})};this.dettach=function(e){e.editable.off();e.popover.off();e.handle.off();e.dialog.off();if(e.editor.data("options").airMode){e.dropzone.off();e.toolbar.off();e.statusbar.off()}}};var w=function(){var t=function(e,t){var n=t.event;var r=t.value;var i=t.title;var s=t.className;var o=t.dropdown;return'<button type="button"'+' class="btn btn-default btn-sm btn-small'+(s?" "+s:"")+(o?" dropdown-toggle":"")+'"'+(o?' data-toggle="dropdown"':"")+(i?' title="'+i+'"':"")+(n?' data-event="'+n+'"':"")+(r?" data-value='"+r+"'":"")+' tabindex="-1">'+e+(o?' <span class="caret"></span>':"")+"</button>"+(o||"")};var i=function(e,n){var r='<i class="'+e+'"></i>';return t(r,n)};var o=function(e,t){return'<div class="'+e+' popover bottom in" style="display: none;">'+'<div class="arrow"></div>'+'<div class="popover-content">'+t+"</div>"+"</div>"};var u=function(e,t,n,r){return'<div class="'+e+' modal" aria-hidden="false">'+'<div class="modal-dialog">'+'<div class="modal-content">'+(t?'<div class="modal-header">'+'<button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button>'+'<h4 class="modal-title">'+t+"</h4>"+"</div>":"")+'<form class="note-modal-form">'+'<div class="modal-body">'+'<div class="row-fluid">'+n+"</div>"+"</div>"+(r?'<div class="modal-footer">'+r+"</div>":"")+"</form>"+"</div>"+"</div>"+"</div>"};var a={picture:function(e){return i("fa fa-picture-o icon-picture",{event:"showImageDialog",title:e.image.image})},link:function(e){return i("fa fa-link icon-link",{event:"showLinkDialog",title:e.link.link})},video:function(e){return i("fa fa-youtube-play icon-play",{event:"showVideoDialog",title:e.video.video})},table:function(e){var t='<ul class="dropdown-menu">'+'<div class="note-dimension-picker">'+'<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>'+'<div class="note-dimension-picker-highlighted"></div>'+'<div class="note-dimension-picker-unhighlighted"></div>'+"</div>"+'<div class="note-dimension-display"> 1 x 1 </div>'+"</ul>";return i("fa fa-table icon-table",{title:e.table.table,dropdown:t})},style:function(e,t){var n=t.styleTags.reduce(function(t,n){var r=e.style[n==="p"?"normal":n];return t+'<li><a data-event="formatBlock" href="#" data-value="'+n+'">'+(n==="p"||n==="pre"?r:"<"+n+">"+r+"</"+n+">")+"</a></li>"},"");return i("fa fa-magic icon-magic",{title:e.style.style,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},fontname:function(e,n){var r=n.fontNames.reduce(function(e,t){return e+'<li><a data-event="fontName" href="#" data-value="'+t+'">'+'<i class="fa fa-check icon-ok"></i> '+t+"</a></li>"},"");var i='<span class="note-current-fontname">'+n.defaultFontName+"</span>";return t(i,{title:e.font.name,dropdown:'<ul class="dropdown-menu">'+r+"</ul>"})},fontsize:function(e,n){var r=n.fontSizes.reduce(function(e,t){return e+'<li><a data-event="fontSize" href="#" data-value="'+t+'">'+'<i class="fa fa-check icon-ok"></i> '+t+"</a></li>"},"");var i='<span class="note-current-fontsize">11</span>';return t(i,{title:e.font.size,dropdown:'<ul class="dropdown-menu">'+r+"</ul>"})},color:function(e){var n='<i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i>';var r=t(n,{className:"note-recent-color",title:e.color.recent,event:"color",value:'{"backColor":"yellow"}'});var i='<ul class="dropdown-menu">'+"<li>"+'<div class="btn-group">'+'<div class="note-palette-title">'+e.color.background+"</div>"+'<div class="note-color-reset" data-event="backColor"'+' data-value="inherit" title="'+e.color.transparent+'">'+e.color.setTransparent+"</div>"+'<div class="note-color-palette" data-target-event="backColor"></div>'+"</div>"+'<div class="btn-group">'+'<div class="note-palette-title">'+e.color.foreground+"</div>"+'<div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+e.color.reset+'">'+e.color.resetToDefault+"</div>"+'<div class="note-color-palette" data-target-event="foreColor"></div>'+"</div>"+"</li>"+"</ul>";var s=t("",{title:e.color.more,dropdown:i});return r+s},bold:function(e){return i("fa fa-bold icon-bold",{event:"bold",title:e.font.bold})},italic:function(e){return i("fa fa-italic icon-italic",{event:"italic",title:e.font.italic})},underline:function(e){return i("fa fa-underline icon-underline",{event:"underline",title:e.font.underline})},strikethrough:function(e){return i("fa fa-strikethrough icon-strikethrough",{event:"strikethrough",title:e.font.strikethrough})},superscript:function(e){return i("fa fa-superscript icon-superscript",{event:"superscript",title:e.font.superscript})},subscript:function(e){return i("fa fa-subscript icon-subscript",{event:"subscript",title:e.font.subscript})},clear:function(e){return i("fa fa-eraser icon-eraser",{event:"removeFormat",title:e.font.clear})},ul:function(e){return i("fa fa-list-ul icon-list-ul",{event:"insertUnorderedList",title:e.lists.unordered})},ol:function(e){return i("fa fa-list-ol icon-list-ol",{event:"insertOrderedList",title:e.lists.ordered})},paragraph:function(e){var t=i("fa fa-align-left icon-align-left",{title:e.paragraph.left,event:"justifyLeft"});var n=i("fa fa-align-center icon-align-center",{title:e.paragraph.center,event:"justifyCenter"});var r=i("fa fa-align-right icon-align-right",{title:e.paragraph.right,event:"justifyRight"});var s=i("fa fa-align-justify icon-align-justify",{title:e.paragraph.justify,event:"justifyFull"});var o=i("fa fa-outdent icon-indent-left",{title:e.paragraph.outdent,event:"outdent"});var u=i("fa fa-indent icon-indent-right",{title:e.paragraph.indent,event:"indent"});var a='<div class="dropdown-menu">'+'<div class="note-align btn-group">'+t+n+r+s+"</div>"+'<div class="note-list btn-group">'+u+o+"</div>"+"</div>";return i("fa fa-align-left icon-align-left",{title:e.paragraph.paragraph,dropdown:a})},height:function(e,t){var n=t.lineHeights.reduce(function(e,t){return e+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'">'+'<i class="fa fa-check icon-ok"></i> '+t+"</a></li>"},"");return i("fa fa-text-height icon-text-height",{title:e.font.height,dropdown:'<ul class="dropdown-menu">'+n+"</ul>"})},help:function(e){return i("fa fa-question icon-question",{event:"showHelpDialog",title:e.options.help})},fullscreen:function(e){return i("fa fa-arrows-alt icon-fullscreen",{event:"fullscreen",title:e.options.fullscreen})},codeview:function(e){return i("fa fa-code icon-code",{event:"codeview",title:e.options.codeview})},undo:function(e){return i("fa fa-undo icon-undo",{event:"undo",title:e.history.undo})},redo:function(e){return i("fa fa-repeat icon-repeat",{event:"redo",title:e.history.redo})},hr:function(e){return i("fa fa-minus icon-hr",{event:"insertHorizontalRule",title:e.hr.insert})}};var f=function(e,n){var r=function(){var t=i("fa fa-edit icon-edit",{title:e.link.edit,event:"showLinkDialog"});var n=i("fa fa-unlink icon-unlink",{title:e.link.unlink,event:"unlink"});var r='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;'+'<div class="note-insert btn-group">'+t+n+"</div>";return o("note-link-popover",r)};var s=function(){var n=t('<span class="note-fontsize-10">100%</span>',{title:e.image.resizeFull,event:"resize",value:"1"});var r=t('<span class="note-fontsize-10">50%</span>',{title:e.image.resizeHalf,event:"resize",value:"0.5"});var s=t('<span class="note-fontsize-10">25%</span>',{title:e.image.resizeQuarter,event:"resize",value:"0.25"});var u=i("fa fa-align-left icon-align-left",{title:e.image.floatLeft,event:"floatMe",value:"left"});var a=i("fa fa-align-right icon-align-right",{title:e.image.floatRight,event:"floatMe",value:"right"});var f=i("fa fa-align-justify icon-align-justify",{title:e.image.floatNone,event:"floatMe",value:"none"});var l=i("fa fa-pencil-square-o icon-pencil-square",{title:e.image.edit,event:"editButton",value:"none"});var c=i("fa fa-trash-o icon-trash",{title:e.image.remove,event:"removeMedia",value:"none"});var h='<div class="btn-group">'+n+r+s+"</div>"+'<div class="btn-group">'+u+a+f+"</div>"+'<div class="btn-group">'+l+"</div>"+'<div class="btn-group">'+c+"</div>";return o("note-image-popover",h)};var u=function(){var t="";for(var r=0,i=n.airPopover.length;r<i;r++){var s=n.airPopover[r];t+='<div class="note-'+s[0]+' btn-group">';for(var u=0,f=s[1].length;u<f;u++){t+=a[s[1][u]](e,n)}t+="</div>"}return o("note-air-popover",t)};return'<div class="note-popover">'+r()+s()+(n.airMode?u():"")+"</div>"};var l=function(){return'<div class="note-handle">'+'<div class="note-control-selection">'+'<div class="note-control-selection-bg"></div>'+'<div class="note-control-holder note-control-nw"></div>'+'<div class="note-control-holder note-control-ne"></div>'+'<div class="note-control-holder note-control-sw"></div>'+'<div class="note-control-sizing note-control-se"></div>'+'<div class="note-control-selection-info"></div>'+"</div>"+"</div>"};var c=function(e,t){return'<table class="note-shortcut">'+"<thead>"+"<tr><th></th><th>"+e+"</th></tr>"+"</thead>"+"<tbody>"+t+"</tbody>"+"</table>"};var h=function(e){var t="<tr><td>⌘ + B</td><td>"+e.font.bold+"</td></tr>"+"<tr><td>⌘ + I</td><td>"+e.font.italic+"</td></tr>"+"<tr><td>⌘ + U</td><td>"+e.font.underline+"</td></tr>"+"<tr><td>⌘ + ⇧ + S</td><td>"+e.font.strikethrough+"</td></tr>"+"<tr><td>⌘ + \\</td><td>"+e.font.clear+"</td></tr>";return c(e.shortcut.textFormatting,t)};var p=function(e){var t="<tr><td>⌘ + Z</td><td>"+e.history.undo+"</td></tr>"+"<tr><td>⌘ + ⇧ + Z</td><td>"+e.history.redo+"</td></tr>"+"<tr><td>⌘ + ]</td><td>"+e.paragraph.indent+"</td></tr>"+"<tr><td>⌘ + [</td><td>"+e.paragraph.outdent+"</td></tr>"+"<tr><td>⌘ + ENTER</td><td>"+e.hr.insert+"</td></tr>";return c(e.shortcut.action,t)};var d=function(e){var t="<tr><td>⌘ + ⇧ + L</td><td>"+e.paragraph.left+"</td></tr>"+"<tr><td>⌘ + ⇧ + E</td><td>"+e.paragraph.center+"</td></tr>"+"<tr><td>⌘ + ⇧ + R</td><td>"+e.paragraph.right+"</td></tr>"+"<tr><td>⌘ + ⇧ + J</td><td>"+e.paragraph.justify+"</td></tr>"+"<tr><td>⌘ + ⇧ + NUM7</td><td>"+e.lists.ordered+"</td></tr>"+"<tr><td>⌘ + ⇧ + NUM8</td><td>"+e.lists.unordered+"</td></tr>";return c(e.shortcut.paragraphFormatting,t)};var v=function(e){var t="<tr><td>⌘ + NUM0</td><td>"+e.style.normal+"</td></tr>"+"<tr><td>⌘ + NUM1</td><td>"+e.style.h1+"</td></tr>"+"<tr><td>⌘ + NUM2</td><td>"+e.style.h2+"</td></tr>"+"<tr><td>⌘ + NUM3</td><td>"+e.style.h3+"</td></tr>"+"<tr><td>⌘ + NUM4</td><td>"+e.style.h4+"</td></tr>"+"<tr><td>⌘ + NUM5</td><td>"+e.style.h5+"</td></tr>"+"<tr><td>⌘ + NUM6</td><td>"+e.style.h6+"</td></tr>";return c(e.shortcut.documentStyle,t)};var m=function(e,t){var n=t.extraKeys;var r="";for(var i in n){if(n.hasOwnProperty(i)){r+="<tr><td>"+i+"</td><td>"+n[i]+"</td></tr>"}}return c(e.shortcut.extraKeys,r)};var g=function(e,t){var n='<table class="note-shortcut-layout">'+"<tbody>"+"<tr><td>"+p(e,t)+"</td><td>"+h(e,t)+"</td></tr>"+"<tr><td>"+v(e,t)+"</td><td>"+d(e,t)+"</td></tr>";if(t.extraKeys){n+='<tr><td colspan="2">'+m(e,t)+"</td></tr>"}n+="</tbody</table>";return n};var y=function(e){return e.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")};var b=function(e,t){var r=function(){var t='<div class="note-image-uploader"><h5>'+e.image.selectFromFiles+"</h5>"+'<input class="note-image-input" type="file" name="files" accept="image/*" /></div>'+"<h5>"+e.image.url+"</h5>"+'<input class="note-image-url form-control span12" type="text" />';var n='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+e.image.insert+"</button>";return u("note-image-dialog",e.image.insert,t,n)};var i=function(){var n='<div class="form-group">'+"<label>"+e.link.textToDisplay+"</label>"+'<input class="note-link-text form-control span12" type="text" />'+"</div>"+'<div class="form-group">'+"<label>"+e.link.url+"</label>"+'<input class="note-link-url form-control span12" type="text" />'+"</div>"+(!t.disableLinkTarget?'<div class="checkbox">'+"<label>"+'<input type="checkbox" checked> '+e.link.openInNewWindow+"</label>"+"</div>":"");var r='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+e.link.insert+"</button>";return u("note-link-dialog",e.link.insert,n,r)};var s=function(){var t='<div class="form-group">'+"<label>"+e.video.url+'</label>&nbsp;<small class="text-muted">'+e.video.providers+"</small>"+'<input class="note-video-url form-control span12" type="text" />'+"</div>";var n='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+e.video.insert+"</button>";return u("note-video-dialog",e.video.insert,t,n)};var o=function(){var r='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+e.shortcut.close+"</a>"+'<div class="title">'+e.shortcut.shortcuts+"</div>"+(n.bMac?g(e,t):y(g(e,t)))+'<p class="text-center">'+'<a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.2</a> · '+'<a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · '+'<a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a>'+"</p>";return u("note-help-dialog","",r,"")};return'<div class="note-dialog">'+r()+i()+s()+o()+"</div>"};var w=function(){return'<div class="note-resizebar">'+'<div class="note-icon-bar"></div>'+'<div class="note-icon-bar"></div>'+'<div class="note-icon-bar"></div>'+"</div>"};var E=function(e){if(n.bMac){e=e.replace("CMD","⌘").replace("SHIFT","⇧")}return e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")};var S=function(t,n,i){var s=r.invertObject(n);var o=t.find("button");o.each(function(t,n){var r=e(n);var i=s[r.data("event")];if(i){r.attr("title",function(e,t){return t+" ("+E(i)+")"})}}).tooltip({container:"body",trigger:"hover",placement:i||"top"}).on("click",function(){e(this).tooltip("hide")})};var x=function(t,n){var r=n.colors;t.find(".note-color-palette").each(function(){var t=e(this),n=t.attr("data-target-event");var i=[];for(var s=0,o=r.length;s<o;s++){var u=r[s];var a=[];for(var f=0,l=u.length;f<l;f++){var c=u[f];a.push(['<button type="button" class="note-color-btn" style="background-color:',c,';" data-event="',n,'" data-value="',c,'" title="',c,'" data-toggle="button" tabindex="-1"></button>'].join(""))}i.push("<div>"+a.join("")+"</div>")}t.html(i.join(""))})};this.createLayoutByAirMode=function(t,i){var s=i.keyMap[n.bMac?"mac":"pc"];var o=e.summernote.lang[i.lang];var u=r.uniqueId();t.addClass("note-air-editor note-editable");t.attr({id:"note-editor-"+u,contentEditable:true});var a=document.body;var c=e(f(o,i));c.addClass("note-air-layout");c.attr("id","note-popover-"+u);c.appendTo(a);S(c,s);x(c,i);var h=e(l());h.addClass("note-air-layout");h.attr("id","note-handle-"+u);h.appendTo(a);var p=e(b(o,i));p.addClass("note-air-layout");p.attr("id","note-dialog-"+u);p.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")});p.appendTo(a)};this.createLayoutByFrame=function(t,r){var i=e('<div class="note-editor"></div>');if(r.width){i.width(r.width)}if(r.height>0){e('<div class="note-statusbar">'+(r.disableResizeEditor?"":w())+"</div>").prependTo(i)}var o=!t.is(":disabled");var u=e('<div class="note-editable" contentEditable="'+o+'"></div>').prependTo(i);if(r.height){u.height(r.height)}if(r.direction){u.attr("dir",r.direction)}u.html(s.html(t)||s.emptyPara);e('<textarea class="note-codable"></textarea>').prependTo(i);var c=e.summernote.lang[r.lang];var h="";for(var p=0,d=r.toolbar.length;p<d;p++){var v=r.toolbar[p];h+='<div class="note-'+v[0]+' btn-group">';for(var m=0,g=v[1].length;m<g;m++){h+=a[v[1][m]](c,r)}h+="</div>"}h='<div class="note-toolbar btn-toolbar">'+h+"</div>";var y=e(h).prependTo(i);var E=r.keyMap[n.bMac?"mac":"pc"];x(y,r);S(y,E,"bottom");var T=e(f(c,r)).prependTo(i);x(T,r);S(T,E);e(l()).prependTo(i);var N=e(b(c,r)).prependTo(i);N.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")});e('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(i);i.insertAfter(t);t.hide()};this.noteEditorFromHolder=function(t){if(t.hasClass("note-air-editor")){return t}else if(t.next().hasClass("note-editor")){return t.next()}else{return e()}};this.createLayout=function(e,t){if(this.noteEditorFromHolder(e).length){return}if(t.airMode){this.createLayoutByAirMode(e,t)}else{this.createLayoutByFrame(e,t)}};this.layoutInfoFromHolder=function(e){var t=this.noteEditorFromHolder(e);if(!t.length){return}var n=s.buildLayoutInfo(t);for(var r in n){if(n.hasOwnProperty(r)){n[r]=n[r].call()}}return n};this.removeLayout=function(e){var t=this.layoutInfoFromHolder(e);if(!t){return}e.html(t.editable.html());t.editor.remove();e.show()}};e.summernote=e.summernote||{};e.extend(e.summernote,o);var E=new w;var S=new b;e.fn.extend({summernote:function(t){t=e.extend({},e.summernote.options,t);this.each(function(n,r){var i=e(r);E.createLayout(i,t);var o=E.layoutInfoFromHolder(i);S.attach(o,t);if(s.isTextarea(i[0])){i.closest("form").submit(function(){i.html(i.code())})}});if(this.first().length&&t.focus){var n=E.layoutInfoFromHolder(this.first());n.editable.focus()}if(this.length&&t.oninit){t.oninit()}return this},code:function(t){if(t===undefined){var r=this.first();if(!r.length){return}var i=E.layoutInfoFromHolder(r);if(!!(i&&i.editable)){var s=i.editor.hasClass("codeview");if(s&&n.bCodeMirror){i.codable.data("cmEditor").save()}return s?i.codable.val():i.editable.html()}return r.html()}this.each(function(n,r){var i=E.layoutInfoFromHolder(e(r));if(i&&i.editable){i.editable.html(t)}});return this},destroy:function(){this.each(function(t,n){var r=e(n);var i=E.layoutInfoFromHolder(r);if(!i||!i.editable){return}S.dettach(i);E.removeLayout(r)});return this}})})